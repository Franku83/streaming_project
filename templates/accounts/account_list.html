{% extends 'base.html' %}

{% block title %}Lista de Cuentas{% endblock %}

{% block content %}
<div class="max-w-7xl mx-auto py-6 sm:px-6 lg:px-8">
    <div class="flex justify-between items-center mb-6">
        <h1 class="text-3xl font-bold text-gray-800">Cuentas de Streaming</h1>
        <a href="{% url 'account_create' %}" class="inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors">
            <svg class="h-5 w-5 mr-2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                <path fill-rule="evenodd" d="M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z" clip-rule="evenodd" />
            </svg>
            Agregar Cuenta
        </a>
    </div>

    {% if messages %}
        {% for message in messages %}
        <div class="mb-4 p-4 rounded-md {% if message.tags %}bg-{{ message.tags }}-100{% else %}bg-green-100{% endif %}">
            <p class="text-sm font-medium {% if message.tags %}text-{{ message.tags }}-800{% else %}text-green-800{% endif %}">{{ message }}</p>
        </div>
        {% endfor %}
    {% endif %}

    <div class="flex flex-col gap-8">
        {% include 'accounts/partials/account_table.html' with accounts=expiring_soon_accounts title='Vencen Pronto (Próximos 7 días)' table_id='expiring-soon-table' empty_message='No hay cuentas por vencer pronto.' %}
        {% include 'accounts/partials/account_table.html' with accounts=expired_accounts title='Cuentas Vencidas' table_id='expired-table' empty_message='No hay cuentas vencidas.' %}
        {% include 'accounts/partials/account_table.html' with accounts=other_accounts title='Otras Cuentas' table_id='other-accounts-table' empty_message='No hay otras cuentas.' %}
    </div>

</div>

<!-- Script para copiar el mensaje -->
<script>
    function copyMessageToClipboard(message) {
        // Usa una API de navegador más moderna para copiar al portapapeles
        navigator.clipboard.writeText(message).then(() => {
            alert('¡Mensaje copiado al portapapeles!');
        }).catch(err => {
            console.error('Error al copiar el texto: ', err);
            // Fallback para navegadores antiguos
            const textarea = document.createElement('textarea');
            textarea.value = message;
            document.body.appendChild(textarea);
            textarea.select();
            document.execCommand('copy');
            document.body.removeChild(textarea);
            alert('¡Mensaje copiado al portapapeles! (Método de respaldo)');
        });
    }
</script>

{% endblock %}

